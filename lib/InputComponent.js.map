{"version":3,"sources":["InputComponent.js"],"names":["InputComponent","props","context","value","defaultValue","state","componentDidMount","attachForm","componentWillReceiveProps","nextProps","setState","shouldComponentUpdate","nextState","componentWillUnmount","detachForm","onChange","e","callback","isDisabled","disabled","isReadOnly","readOnly","getValue","getStyleStates","valid","states","invalid","displayName","propTypes","name","string","bool","func","defaultProps","contextTypes"],"mappings":"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","file":"InputComponent.js","sourcesContent":["/**\n* Copyright 2016 Baidu Inc. All rights reserved.\n*\n* @file InputComponent\n* @author leon <ludafa@outlook.com>\n*/\n\nimport {Component, PropTypes} from 'react';\nimport shallowEqual from './util/shallowEqual';\n\nexport default class InputComponent extends Component {\n\n    constructor(props, context = {}) {\n        super(props, context);\n        const {value, defaultValue} = props;\n        this.state = {\n            value: value === void 0 ? defaultValue : value\n        };\n    }\n\n    /**\n     * 这里主要做一件事，就是注册到 form 上，让 form 在 getData() / validate() 时避免递归遍历\n     */\n    componentDidMount() {\n\n        const attachForm = this.context.attachForm;\n\n        if (attachForm) {\n            attachForm(this);\n        }\n\n    }\n\n    /**\n     * 接收属性处理\n     *\n     * 我们在这里主要是做 value 更新和校验计算\n     *\n     * ### 值更新\n     *\n     * 这个事情把实体控件的的 controlled / uncontrolled 处理解放了\n     * 实体控件只需要做 render 和 事件处理就好了\n     *\n     * @param {Object} nextProps 新属性\n     */\n    componentWillReceiveProps(nextProps) {\n\n        let {value, defaultValue} = nextProps;\n\n        if (value === void 0) {\n            value = defaultValue;\n        }\n\n        if (value !== this.state.value) {\n            this.setState({value});\n        }\n\n    }\n\n    /**\n     * 是否应当更新组件\n     *\n     * @param {*} nextProps 下一个属性\n     * @param {*} nextState 下一个状态\n     * @return {boolean}\n     */\n    shouldComponentUpdate(nextProps, nextState) {\n        return !shallowEqual(this.props, nextProps) || !shallowEqual(this.state, nextState);\n    }\n\n    componentWillUnmount() {\n\n        const detachForm = this.context.detachForm;\n\n        if (detachForm) {\n            detachForm(this);\n        }\n\n    }\n\n    /**\n     * 值变化处理函数\n     *\n     * @param {Object}  e         值变化事件\n     * @param {Function} callback 完成更新后回调\n     */\n    onChange(e, callback) {\n\n        const {onChange, value} = this.props;\n\n        // 在 React 中，只要 props 中的 value 是 undefined\n        // 那么 input 就会进入 uncontrolled 模式\n        // 这种对应着 controlled 组件逻辑，controlled 模式我们就啥也不管啦\n        if (value !== void 0) {\n            onChange && onChange(e);\n            callback && callback();\n            return;\n        }\n\n        // 这种对应 uncontrolled 逻辑\n        if (e.value !== this.state.value) {\n            this.setState({value: e.value}, callback);\n        }\n\n    }\n\n    isDisabled() {\n        return this.props.disabled;\n    }\n\n    isReadOnly() {\n        return this.props.readOnly;\n    }\n\n    getValue() {\n        return this.state.value;\n    }\n\n    getStyleStates() {\n\n        const {\n            readOnly,\n            valid,\n            disabled\n        } = this.props;\n\n\n        let states = {};\n\n        if (readOnly !== void 0) {\n            states['read-only'] = readOnly;\n        }\n\n        if (disabled !== void 0) {\n            states.disabled = disabled;\n        }\n\n        if (valid !== void 0) {\n            states.valid = !!valid;\n            states.invalid = !valid;\n        }\n\n        return states;\n\n    }\n\n\n}\n\nInputComponent.displayName = 'InputComponent';\n\nInputComponent.propTypes = {\n    name: PropTypes.string,\n    readOnly: PropTypes.bool,\n    valid: PropTypes.bool,\n    onChange: PropTypes.func\n};\n\nInputComponent.defaultProps = {};\n\nInputComponent.contextTypes = {\n    attachForm: PropTypes.func,\n    detachForm: PropTypes.func\n};\n"]}