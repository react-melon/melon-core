{"version":3,"sources":["util/syncPropsToState.js"],"names":["getNextValue","getNextValidity","getSyncUpdates","component","nextProps","value","defaultValue","disabled","customValidity","state","validity","validator","createCustomValidity","checkValidity"],"mappings":";;;;;;;;;;;;;;;;YAYgBA,Y,GAAAA,Y;YAcAC,e,GAAAA,e;sBA0BQC,c;AApDxB;;;;;AAKA;;;;;;;AAOO,aAASF,YAAT,CAAsBG,SAAtB,EAAiCC,SAAjC,EAA4C;AAAA,YACxCC,KADwC,GACjBD,SADiB,CACxCC,KADwC;AAAA,YACjCC,YADiC,GACjBF,SADiB,CACjCE,YADiC;;AAE/C,eAAOD,UAAU,KAAK,CAAf,GAAmBC,YAAnB,GAAkCD,KAAzC;AACH;;AAED;;;;;;;;;AASO,aAASJ,eAAT,CAAyBE,SAAzB,QAAuE;AAAA,YAAlCE,KAAkC,QAAlCA,KAAkC;AAAA,YAA3BE,QAA2B,QAA3BA,QAA2B;AAAA,YAAjBC,cAAiB,QAAjBA,cAAiB;;;AAE1E;AACA,YAAID,QAAJ,EAAc;AACV,mBAAO,IAAP;AACH;;AAED;AACA,YAAIF,UAAUF,UAAUM,KAAV,CAAgBJ,KAA9B,EAAqC;AACjC,mBAAOF,UAAUM,KAAV,CAAgBC,QAAvB;AACH;;AAED;AACA,eAAOF,iBACDL,UAAUQ,SAAV,CAAoBC,oBAApB,CAAyCJ,cAAzC,CADC,GAEDL,UAAUU,aAAV,CAAwBR,KAAxB,CAFN;AAIH;;AAED;;;;;;;AAOe,aAASH,cAAT,CAAwBC,SAAxB,EAAmCC,SAAnC,EAA8C;;AAEzD,YAAMC,QAAQL,aAAaG,SAAb,EAAwBC,SAAxB,CAAd;AAFyD,YAGlDG,QAHkD,GAGtBH,SAHsB,CAGlDG,QAHkD;AAAA,YAGxCC,cAHwC,GAGtBJ,SAHsB,CAGxCI,cAHwC;;AAIzD,YAAME,WAAWT,gBAAgBE,SAAhB,EAA2B;AACxCE,wBADwC;AAExCG,0CAFwC;AAGxCD;AAHwC,SAA3B,CAAjB;;AAMA,YAAIF,UAAUF,UAAUM,KAAV,CAAgBJ,KAA1B,IAAmCK,aAAaP,UAAUM,KAAV,CAAgBC,QAApE,EAA8E;AAC1E,mBAAO,IAAP;AACH;;AAED,eAAO,EAACL,YAAD,EAAQK,kBAAR,EAAP;AAEH","file":"syncPropsToState.js","sourcesContent":["/**\n * @file 小工具 - 用于做 InputComponent 的 props -> state 的同步\n * @author leon <lupengyu@baidu.com>\n */\n\n/**\n * 获取需要同步到 state 中的 value\n *\n * @param  {ReactComponent} component 组件\n * @param  {Object}         nextProps 新属性\n * @return {*}\n */\nexport function getNextValue(component, nextProps) {\n    const {value, defaultValue} = nextProps;\n    return value === void 0 ? defaultValue : value;\n}\n\n/**\n * 获取需要同步到 state 中的 validity\n *\n * @param {ReactComponent} component 组件\n * @param {string} value 新值\n * @param {bool} disabled 是否可用\n * @param {Object} customValidity 新属性\n * @return {module:Validity}\n */\nexport function getNextValidity(component, {value, disabled, customValidity}) {\n\n    // 如果被禁用了，禁用状态是不进行校验的。那么直接返回 null\n    if (disabled) {\n        return null;\n    }\n\n    // 如果值没有发生变化，那么不需要校验，只在值改变时做校验\n    if (value === component.state.value) {\n        return component.state.validity;\n    }\n\n    // 最后，如果有自定义的出错提示，那么直接用它，不再用校验器做校验。\n    return customValidity\n        ? component.validator.createCustomValidity(customValidity)\n        : component.checkValidity(value);\n\n}\n\n/**\n * 获取需要同步到 state 中的新属性们\n *\n * @param  {ReactComponent} component 组件\n * @param  {Object}         nextProps 新属性\n * @return {Object}\n */\nexport default function getSyncUpdates(component, nextProps) {\n\n    const value = getNextValue(component, nextProps);\n    const {disabled, customValidity} = nextProps;\n    const validity = getNextValidity(component, {\n        value,\n        customValidity,\n        disabled\n    });\n\n    if (value === component.state.value && validity === component.state.validity) {\n        return null;\n    }\n\n    return {value, validity};\n\n}\n"]}